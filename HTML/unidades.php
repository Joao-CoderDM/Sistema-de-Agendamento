<?php include_once('topo.php'); ?>

    <link rel="stylesheet" href="../CSS/SistemaWeb/style_unidades.css">

    <!-- Banner principal melhorado -->
    <div class="hero-section">
        <div class="container mt-4">
            <div class="row">
                <div class="col-lg-8 offset-lg-2 text-center">
                    <h1 class="display-4 fw-bold">Encontre Uma Unidade</h1>
                    <div class="title-underline mx-auto mb-4"></div>
                    <p class="lead mb-4">Temos unidades estrategicamente distribuídas para estar sempre perto de você. Escolha a mais conveniente e venha experimentar nossos serviços de excelência.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="container mt-5">
        <!-- Cards de Unidades - Primeira linha -->
        <div class="row">
            <!-- Unidade 1 -->
            <div class="col-md-4 mb-4">
                <div class="card unidade-card h-100">
                    <div class="card-ribbon">
                        <span>Sul</span>
                    </div>
                    <div class="card-img-overlay-top">
                        <span class="badge rounded-pill status-open">Aberto Agora</span>
                    </div>
                    <img src="../Imagens/unidade1.jpg" class="card-img-top img-unidade" alt="Unidade Araranguá">
                    <div class="card-body">
                        <h5 class="card-title">Araranguá</h5>
                        <p class="card-text">
                            <i class="bi bi-geo-alt me-2"></i>Av. Sete de Setembro, 224 – Centro<br>
                            <i class="bi bi-building me-2"></i>Araranguá – SC – Brasil<br>
                            <i class="bi bi-telephone me-2"></i>(48) 99121-0919
                        </p>
                        <div class="card-schedule">
                            <p class="mb-1"><strong><i class="bi bi-clock me-2"></i>Horário de Funcionamento:</strong></p>
                            <p class="mb-0">Segunda à Sábado: 9h às 20h</p>
                            <p>Domingos e Feriados: 10h às 16h</p>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent border-0">
                        <a href="https://maps.google.com" target="_blank" class="btn btn-outline-light w-100"><i class="bi bi-map me-2"></i>Ver no Mapa</a>
                    </div>
                </div>
            </div>

            <!-- Unidade 2 -->
            <div class="col-md-4 mb-4">
                <div class="card unidade-card h-100">
                    <div class="card-ribbon">
                        <span>Capital</span>
                    </div>
                    <div class="card-img-overlay-top">
                        <span class="badge rounded-pill status-open">Aberto Agora</span>
                    </div>
                    <img src="../Imagens/unidade2.jpg" class="card-img-top img-unidade" alt="Unidade Florianópolis">
                    <div class="card-body">
                        <h5 class="card-title">Florianópolis</h5>
                        <p class="card-text">
                            <i class="bi bi-geo-alt me-2"></i>R. Lauro Linhares, 1015 – Trindade<br>
                            <i class="bi bi-building me-2"></i>Florianópolis – SC – Brasil<br>
                            <i class="bi bi-telephone me-2"></i>(48) 3307-5337
                        </p>
                        <div class="card-schedule">
                            <p class="mb-1"><strong><i class="bi bi-clock me-2"></i>Horário de Funcionamento:</strong></p>
                            <p class="mb-0">Segunda à Sábado: 9h às 21h</p>
                            <p>Domingos e Feriados: 9h às 18h</p>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent border-0">
                        <a href="https://maps.google.com" target="_blank" class="btn btn-outline-light w-100"><i class="bi bi-map me-2"></i>Ver no Mapa</a>
                    </div>
                </div>
            </div>

            <!-- Unidade 3 -->
            <div class="col-md-4 mb-4">
                <div class="card unidade-card h-100">
                    <div class="card-ribbon">
                        <span>Sul</span>
                    </div>
                    <div class="card-img-overlay-top">
                        <span class="badge rounded-pill status-open">Aberto Agora</span>
                    </div>
                    <img src="../Imagens/unidade3.jpg" class="card-img-top img-unidade" alt="Unidade Criciúma">
                    <div class="card-body">
                        <h5 class="card-title">Criciúma</h5>
                        <p class="card-text">
                            <i class="bi bi-geo-alt me-2"></i>R. Joaquim Nabuco, 267 – Centro<br>
                            <i class="bi bi-building me-2"></i>Criciúma – SC – Brasil<br>
                            <i class="bi bi-telephone me-2"></i>(48) 3413-9277
                        </p>
                        <div class="card-schedule">
                            <p class="mb-1"><strong><i class="bi bi-clock me-2"></i>Horário de Funcionamento:</strong></p>
                            <p class="mb-0">Segunda à Sexta: 8h às 20h</p>
                            <p>Sábados: 9h às 18h</p>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent border-0">
                        <a href="https://maps.google.com" target="_blank" class="btn btn-outline-light w-100"><i class="bi bi-map me-2"></i>Ver no Mapa</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cards de Unidades - Segunda linha -->
        <div class="row">
            <!-- Unidade 4 -->
            <div class="col-md-4 mb-4">
                <div class="card unidade-card h-100">
                    <div class="card-ribbon">
                        <span>Vale do Itajaí</span>
                    </div>
                    <div class="card-img-overlay-top">
                        <span class="badge rounded-pill status-open">Aberto Agora</span>
                    </div>
                    <img src="../Imagens/unidade4.jpg" class="card-img-top img-unidade" alt="Unidade Blumenau">
                    <div class="card-body">
                        <h5 class="card-title">Blumenau</h5>
                        <p class="card-text">
                            <i class="bi bi-geo-alt me-2"></i>R. XV de Novembro, 550 – Centro<br>
                            <i class="bi bi-building me-2"></i>Blumenau – SC – Brasil<br>
                            <i class="bi bi-telephone me-2"></i>(47) 3232-8855
                        </p>
                        <div class="card-schedule">
                            <p class="mb-1"><strong><i class="bi bi-clock me-2"></i>Horário de Funcionamento:</strong></p>
                            <p class="mb-0">Segunda à Sábado: 9h às 20h</p>
                            <p>Domingos: Fechado</p>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent border-0">
                        <a href="https://maps.google.com" target="_blank" class="btn btn-outline-light w-100"><i class="bi bi-map me-2"></i>Ver no Mapa</a>
                    </div>
                </div>
            </div>

            <!-- Unidade 5 -->
            <div class="col-md-4 mb-4">
                <div class="card unidade-card h-100">
                    <div class="card-ribbon">
                        <span>Litoral Norte</span>
                    </div>
                    <div class="card-img-overlay-top">
                        <span class="badge rounded-pill status-open">Aberto Agora</span>
                    </div>
                    <img src="../Imagens/unidade5.jpg" class="card-img-top img-unidade" alt="Unidade Balneário Camboriú">
                    <div class="card-body">
                        <h5 class="card-title">Balneário Camboriú</h5>
                        <p class="card-text">
                            <i class="bi bi-geo-alt me-2"></i>Av. Atlântica, 1200 – Centro<br>
                            <i class="bi bi-building me-2"></i>Balneário Camboriú – SC – Brasil<br>
                            <i class="bi bi-telephone me-2"></i>(47) 3366-4422
                        </p>
                        <div class="card-schedule">
                            <p class="mb-1"><strong><i class="bi bi-clock me-2"></i>Horário de Funcionamento:</strong></p>
                            <p class="mb-0">Segunda à Domingo: 10h às 22h</p>
                            <p>Feriados: 12h às 20h</p>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent border-0">
                        <a href="https://maps.google.com" target="_blank" class="btn btn-outline-light w-100"><i class="bi bi-map me-2"></i>Ver no Mapa</a>
                    </div>
                </div>
            </div>

            <!-- Unidade 6 -->
            <div class="col-md-4 mb-4">
                <div class="card unidade-card h-100">
                    <div class="card-ribbon">
                        <span>Oeste</span>
                    </div>
                    <div class="card-img-overlay-top">
                        <span class="badge rounded-pill status-open">Aberto Agora</span>
                    </div>
                    <img src="../Imagens/unidade6.jpg" class="card-img-top img-unidade" alt="Unidade Chapecó">
                    <div class="card-body">
                        <h5 class="card-title">Chapecó</h5>
                        <p class="card-text">
                            <i class="bi bi-geo-alt me-2"></i>Av. Getúlio Vargas, 789 – Centro<br>
                            <i class="bi bi-building me-2"></i>Chapecó – SC – Brasil<br>
                            <i class="bi bi-telephone me-2"></i>(49) 3322-7788
                        </p>
                        <div class="card-schedule">
                            <p class="mb-1"><strong><i class="bi bi-clock me-2"></i>Horário de Funcionamento:</strong></p>
                            <p class="mb-0">Segunda à Sexta: 8h30 às 19h</p>
                            <p>Sábados: 8h30 às 17h</p>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent border-0">
                        <a href="https://maps.google.com" target="_blank" class="btn btn-outline-light w-100"><i class="bi bi-map me-2"></i>Ver no Mapa</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Estatísticas de unidades -->
        <div class="row mt-5 mb-5 stats-section">
            <?php
            // Conexão com o banco de dados
            include_once('../Conexao/conexao.php');
            
            // Valores padrão caso ocorra erro
            $total_unidades = 6;
            $total_cidades = 6;
            $total_profissionais = 38;
            $media_avaliacao = 4.9;
            
            // Verifica se a tabela 'unidades' existe
            try {
                $check_table = $pdo->query("SHOW TABLES LIKE 'unidades'");
                
                // Se a tabela existir, faz as consultas
                if ($check_table->rowCount() > 0) {
                    // Consulta para o número de unidades
                    $query_unidades = "SELECT COUNT(*) as total FROM unidades";
                    $result_unidades = $pdo->query($query_unidades);
                    if ($result_unidades) {
                        $total_unidades = $result_unidades->fetchColumn();
                    }
                    
                    // Consulta para o número de cidades distintas
                    $query_cidades = "SELECT COUNT(DISTINCT cidade) as total FROM unidades";
                    $result_cidades = $pdo->query($query_cidades);
                    if ($result_cidades) {
                        $total_cidades = $result_cidades->fetchColumn();
                    }
                }
                
                // Consulta para o número de profissionais (essa tabela deve existir)
                $check_usuario_table = $pdo->query("SHOW TABLES LIKE 'usuario'");
                
                if ($check_usuario_table->rowCount() > 0) {
                    $query_profissionais = "SELECT COUNT(*) as total FROM usuario WHERE tipo_usuario = 'profissional'";
                    $result_profissionais = $pdo->query($query_profissionais);
                    if ($result_profissionais) {
                        $total_profissionais = $result_profissionais->fetchColumn();
                    }
                }
                
                // Consulta para a média das avaliações
                $check_feedback_table = $pdo->query("SHOW TABLES LIKE 'feedback'");
                
                if ($check_feedback_table->rowCount() > 0) {
                    $query_avaliacao = "SELECT AVG(avaliacao) as media FROM feedback";
                    $result_avaliacao = $pdo->query($query_avaliacao);
                    if ($result_avaliacao) {
                        $row = $result_avaliacao->fetch(PDO::FETCH_ASSOC);
                        if ($row && $row['media'] !== null) {
                            $media_avaliacao = number_format($row['media'], 1);
                        }
                    }
                }
                
            } catch (Exception $e) {
                // Em caso de erro, manterá os valores padrão definidos anteriormente
                // Poderia-se adicionar um log de erro aqui se necessário
            }
            ?>
            
            <div class="col-md-3 col-6 text-center mb-4 mb-md-0">
                <div class="stat-item">
                    <i class="bi bi-shop"></i>
                    <h3><?php echo $total_unidades; ?></h3>
                    <p>Unidades</p>
                </div>
            </div>
            <div class="col-md-3 col-6 text-center mb-4 mb-md-0">
                <div class="stat-item">
                    <i class="bi bi-geo-alt"></i>
                    <h3><?php echo $total_cidades; ?></h3>
                    <p>Cidades</p>
                </div>
            </div>
            <div class="col-md-3 col-6 text-center">
                <div class="stat-item">
                    <i class="bi bi-people"></i>
                    <h3><?php echo $total_profissionais; ?></h3>
                    <p>Profissionais</p>
                </div>
            </div>
            <div class="col-md-3 col-6 text-center">
                <div class="stat-item">
                    <i class="bi bi-star"></i>
                    <h3><?php echo $media_avaliacao; ?></h3>
                    <p>Avaliação média</p>
                </div>
            </div>
        </div>

        <!-- Adiciona espaço entre o conteúdo e o footer -->
        <div class="mb-5"></div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<?php include_once('footer.php'); ?>